datasource db {
  provider = "sqlite"
  url      = "file:./database.db"
}

model Asset {

  id     Int @id @default(autoincrement())
  typeId Int

  code String    @unique
  name String
  type AssetType @relation(fields: [typeId], references: [id])

  ledgerEntry    LedgerEntry[]
  buyAssetTrade  Trade[]         @relation("buyAsset")
  sellAssetTrade Trade[]         @relation("sellAsset")
  yieldTransfer  YieldTransfer[]
}

model AssetType {
  id    Int     @id @default(autoincrement())
  value String  @unique
  asset Asset[]
}

model LedgerEntry {

  id      Int @id @default(autoincrement())
  typeId  Int
  assetId Int

  time    DateTime
  type    LedgerEntryType @relation(fields: [typeId], references: [id])
  asset   Asset           @relation(fields: [assetId], references: [id])
  amount  Decimal
  fee     Decimal
  balance Decimal
}

model LedgerEntryType {
  id          Int           @id @default(autoincrement())
  ledgerEntry LedgerEntry[]
  value       String        @unique
}

model Trade {

  id          Int @id @default(autoincrement())
  buyAssetId  Int
  sellAssetId Int

  time       DateTime
  buyAsset   Asset    @relation("buyAsset", fields: [buyAssetId], references: [id])
  buyAmount  Decimal
  buyFee     Decimal
  buyBalance Decimal

  sellAsset   Asset   @relation("sellAsset", fields: [sellAssetId], references: [id])
  sellAmount  Decimal
  sellFee     Decimal
  sellBalance Decimal
}

model YieldTransfer {

  id      Int @id @default(autoincrement())
  assetId Int

  completionDate DateTime
  account        String
  asset          Asset    @relation(fields: [assetId], references: [id])
  amount         Decimal
}

generator client {
  provider = "prisma-client-js"
}
